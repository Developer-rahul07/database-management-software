<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Management</title>
    <link href="../assets/admin.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <link href="/assets/table1.css" rel="stylesheet">
    <link href="/assets/table2.css" rel="stylesheet">



    <script src="/assets/tablelink.js"></script>
    <script src="/assets/tablelink1.js"></script>

</head>

<body style="background-color:lightblue;">
    <%- include('./public/Navbar.ejs') %>
        <!--Display the links to the pages-->
        <% if(page> 1) { %> <a href="/allsearch?page=<%=page-1%>">Before</a>
            <% } %>
                <% for(let i=iterator; i <=endingLink; i++) { %>
                    <% if(i===page) { %>
                        <a class="selectedLink" href="/allsearch?page=<%=i%>">
                            <%=i%>
                        </a>
                        <% continue; %>
                            <% } %>
                                <a href="/allsearch?page=<%=i%>">
                                    <%=i%>
                                </a>
                                <% } %>
                                    <% if(page < numberOfPages) { %> <a href="/allsearch?page=<%=page+1%>">After</a>
                                        <% } %>

                                            <br>

                                            <div class="table-responsive">
                                                <table id="example"
                                                    class="table table-bordred table-striped text-center mb-5">

                                                    <thead>
                                                        <tr>

                                                            <th>FILE NAME</th>
                                                            <th>YEAR</th>
                                                            <th>CODE</th>
                                                            <th>TALUK</th>
                                                            <th>HOBLI</th>
                                                            <th>VILLAGE</th>
                                                            <th>SURVEY NUMBER</th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% console.log("Data in EJS:", data); %>
                                                            <% data.forEach(function(item){ %>

                                                                <%= item.FILENAME %>
                                                                    <tr>

                                                                        <td>
                                                                            <%= item.FILENAME %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.YEAR %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.CODE %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.TALUK %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.HOBLI %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.VILLAGE %>
                                                                        </td>
                                                                        <td>
                                                                            <%= item.SURVEYNUMBER %>
                                                                        </td>

                                                                        <td>
                                                                            <!-- Button to Open the Modal -->

                                                                            <form action="/pdf/:PDFNAME" method="get">
                                                                                <input type="hidden" id="SRNO"
                                                                                    name="SRNO"
                                                                                    value="<%= item.SRNO %>">
                                                                                <input type="hidden" id="FILENAME"
                                                                                    name="FILENAME"
                                                                                    value="<%= item.FILENAME %>">
                                                                                <input type="hidden" id="YEAR"
                                                                                    name="YEAR"
                                                                                    value="<%= item.YEAR %>">
                                                                                <input type="hidden" id="CODE"
                                                                                    name="CODE"
                                                                                    value="<%= item.CODE %>">
                                                                                <input type="hidden" id="TALUK"
                                                                                    name="TALUK"
                                                                                    value="<%= item.TALUK %>">
                                                                                <input type="hidden" id="HOBLI"
                                                                                    name="HOBLI"
                                                                                    value="<%= item.HOBLI %>">
                                                                                <input type="hidden" id="VILLAGE"
                                                                                    name="VILLAGE"
                                                                                    value="<%= item.VILLAGE %>">
                                                                                <input type="hidden" id="SURVEYNUMBER"
                                                                                    name="SURVEYNUMBER"
                                                                                    value="<%= item.SURVEYNUMBER %>">
                                                                                <input type="hidden" id="pdfname"
                                                                                    name="pdfname"
                                                                                    value="<%= item.PDFNAME %>">
                                                                                <input type="hidden" id="comment"
                                                                                    name="comment"
                                                                                    value="<%= item.COMMENT %>">
                                                                                <input type="hidden" id="indexName"
                                                                                    name="indexName"
                                                                                    value="<%= item.listName %>">
                                                                                <input type="hidden" id="listName"
                                                                                    name="listName"
                                                                                    value="<%= item.listName %>">
                                                                                <!-- <input type="submit" <i class="fa fa-eye"></i> > -->
                                                                                <button style="background: bottom;
                                            border: aliceblue;
                                            color: black;"> <i class="fa fa-eye"></i></button>

                                                                            </form>
                                                                        </td>
                                                                    </tr>
                                                                    <% }) %>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <%- include('./public/Navbar.ejs') %>
                                                <br>



                                                <script>
                                                    $(document).ready(function () {
                                                        // Setup - add a text input to each footer cell
                                                        $('table#example thead th').each(function (i) {
                                                            var title = $('#example thead th').eq($(this).index()).text();
                                                            $(this).html('<input type="text" id="filenameInput" placeholder="' + title + '" data-index="' + i + '" />');
                                                        });

                                                        // DataTable
                                                        var table = $('#example').DataTable({
                                                            scrollY: "300px",
                                                            scrollX: true,
                                                            scrollCollapse: true,
                                                            paging: false,
                                                            fixedColumns: true
                                                        });

                                                        // Filter event handler
                                                        $(table.table().container()).on('keyup', 'thead input', function () {
                                                            let searchTerm = $('#filenameInput').val();

                                                            // Make an HTTP request to the server for database search
                                                            $.get('/allsearch', { searchTerm: searchTerm })
                                                            table
                                                                .column($(this).data('index'))
                                                                .search(this.value)
                                                                .draw();
                                                        });
                                                    });
                                                </script>


</body>

</html>